# -----------------------------------------------------------------------------
# IoTGuard Configuration
#
# Purpose
#   - Declare the feature list used by training/inference and the decision
#     policy parameters consumed by the decision loop and dashboard.
#
# Notes
#   - Training reads this feature order (scripts/train_supervised.py).
#   - Decision loop hot-reloads values under `decision` at runtime.
# -----------------------------------------------------------------------------
features:
  # Core flow features (5)
  - flows
  - bytes_total
  - pkts_total
  - syn_ratio
  - mean_bytes_flow
  # Flag ratios for attack detection (3)
  - ack_ratio
  - fin_ratio
  - rst_ratio
  # Protocol features (3)
  - http_ratio
  - tcp_ratio
  - protocol_diversity
  # Statistical features (2)
  - std_bytes
  - iat_mean

lgbm:
  n_estimators: 250
  num_leaves: 64
  learning_rate: 0.05
  subsample: 0.8
  colsample_bytree: 0.8
  
decision:
  threshold: 0.85
  grace: 2
  window: 5
  cooldown_sec: 5
  instant_block: 0.95

  # set to false to actually block
  dry_run: true

  # Blocking is handled by scripts/blocker.py (supports Windows netsh, Linux nftables/iptables)




